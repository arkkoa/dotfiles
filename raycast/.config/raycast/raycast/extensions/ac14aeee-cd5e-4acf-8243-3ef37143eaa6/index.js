"use strict";var E=Object.create;var i=Object.defineProperty;var N=Object.getOwnPropertyDescriptor;var R=Object.getOwnPropertyNames;var j=Object.getPrototypeOf,k=Object.prototype.hasOwnProperty;var B=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),D=(e,t)=>{for(var r in t)i(e,r,{get:t[r],enumerable:!0})},y=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of R(t))!k.call(e,o)&&o!==r&&i(e,o,{get:()=>t[o],enumerable:!(n=N(t,o))||n.enumerable});return e};var c=(e,t,r)=>(r=e!=null?E(j(e)):{},y(t||!e||!e.__esModule?i(r,"default",{value:e,enumerable:!0}):r,e)),M=e=>y(i({},"__esModule",{value:!0}),e);var b=B((ee,h)=>{var q=require("child_process").exec,w=console.debug;function z(e,t={}){let r=G(t),n=t.binary||"tesseract",p=typeof e=="string"&&!e.match(/^https?:\/\//)?`"${e}"`:"stdin",d=[n,p,"stdout",...r].join(" ");return t.debug&&w("command",d),new Promise(($,I)=>{let _=q(d,(g,A,C)=>{t.debug&&w(C),g&&I(g),$(A)});p==="stdin"&&V(e,_)})}function V(e,t){if(typeof e=="string"){let r=e.match(/^(.*?):/)[1];return require(r).get(e,n=>{n.pipe(t.stdin)})}Array.isArray(e)&&(e=Buffer.from(e.join(`
`),"utf-8")),t.stdin.write(e),t.stdin.end()}function G(e){let t=["tessdata-dir","user-words","user-patterns","psm","oem","dpi"];return Object.entries(e).map(([r,n])=>{if(!["debug","presets","binary"].includes(r))return r==="lang"?`-l ${n}`:t.includes(r)?`--${r} ${n}`:`-c ${r}=${n}`}).concat(e.presets).filter(Boolean)}h.exports={recognize:z}});var Y={};D(Y,{default:()=>L});module.exports=M(Y);var s=require("@raycast/api");var x=c(b()),l=require("@raycast/api");async function f(e){let t={lang:(0,l.getPreferenceValues)().tesseract_lang,oem:1,psm:3,binary:(0,l.getPreferenceValues)().tesseract_path};return await(0,x.recognize)(e,t)}var a=require("@raycast/api"),P=c(require("fs")),{private_key:W,client_email:v}=(0,a.getPreferenceValues)();function H(e){let t=(0,a.getPreferenceValues)().newLine;return t==="replaceSpace"?e.replace(/\n/g," "):t==="replaceBreak"?e.replace(/\n/g,"<br>"):e}var J=async()=>P.default.existsSync((0,a.getPreferenceValues)().tesseract_path);async function K(){return!(!W||!v)}var Q={handleNewLines:H,isTesseractInstalled:J,checkGoogleCredentials:K},m=Q;var S=require("@raycast/api"),T=c(require("util")),O=require("child_process"),U=T.default.promisify(O.exec),F=S.environment.assetsPath+"/"+Date.now()+".png",X="/usr/sbin/screencapture -i "+F;async function u(){return await U(X),F}async function L(){if(!await m.isTesseractInstalled()){await(0,s.showToast)({style:s.Toast.Style.Failure,title:"Tesseract not found, check README!",message:"Tesseract path not found or it is not installed, check README for more info!"});return}await(0,s.closeMainWindow)();let t=await u();try{let r=await f(t);if(r=m.handleNewLines(r),!r){await(0,s.showToast)({style:s.Toast.Style.Failure,title:"No text found on image!",message:"No text found on image!"});return}await s.Clipboard.copy(r),await(0,s.showToast)({style:s.Toast.Style.Success,title:"Text copied to clipboard!",message:"Text copied to clipboard!"})}catch{await(0,s.showToast)({style:s.Toast.Style.Failure,title:"Failed to OCR the image!",message:"Failed to OCR the image!"})}}
